# タップカルテ - 思ったことを、そのままカルテに

## プロジェクト概要
- **名前**: タップカルテ
- **キャッチフレーズ**: 思ったことを、そのままカルテに
- **目的**: 看護・介護記録業務効率化を支援するWebアプリケーション
- **機能**: 口頭メモや簡単なメモを、整った看護記録・報告書に変換
- **AIエンジン**: 🚀 **Gemini 2.5 Flash** (2025-10-07 移行完了)

## URL
- **🌐 本番環境**: https://6399bd3e.tap-carte.pages.dev ✅ **Gemini API動作確認済み**
- **🐙 GitHub**: https://github.com/Michimasa-Hiroya/tap-karte
- **🚀 開発環境**: ローカル開発サーバー対応
- **📱 モバイル対応**: レスポンシブデザイン完全対応

## 現在実装済み機能

### ✅ 完了した機能
1. **🤖 AI変換エンジン** 
   - **Gemini 2.5 Flash API**: 高品質な日本語医療記録生成
   - **コスト効率**: 1回0.32円 (Claude比+18%で品質大幅向上)
   - **応答時間**: 6-10秒 (高品質推論)
   - **医療専門用語辞書**: 200語の看護・リハビリ専門用語統合

2. **📝 フォーマット対応**
   - **ドキュメント種別**: 記録 / 報告書
   - **フォーマット**: 文章形式 / SOAP形式
   - **文体選択**: ですます体 / だ・である体 (初期選択: だ・である体)
   - **出力文字数制限**: 100～1000文字（スライダー調整）

3. **🛡️ セキュリティ機能**
   - **個人情報検出**: パターンマッチングによる自動警告
   - **JWT認証**: セキュアなユーザー認証
   - **bcrypt暗号化**: パスワード安全管理
   - **CORS対策**: クロスオリジン攻撃防御

4. **👤 ユーザー管理**
   - **メール+パスワード認証**: 標準ログイン機能
   - **Google OAuth**: ワンクリックログイン
   - **個別履歴管理**: ユーザー別変換履歴保存 (開発中)
   - **セッション管理**: 自動ログイン維持

5. **🎨 UI/UX**
   - **直感的操作**: 2分割レイアウト（入力/出力エリア）
   - **淡いピンクテーマ**: 医療現場に適した優しいデザイン
   - **レスポンシブ対応**: PC・タブレット・スマートフォン最適化
   - **リアルタイム文字数表示**: 入力・出力文字数カウント

## API エンドポイント

### メイン機能
- **GET `/`** - メインUI表示
- **POST `/api/convert`** - Gemini AI テキスト変換
  - `text`: 入力テキスト
  - `style`: "ですます体" / "だ・である体"
  - `docType`: "記録" / "報告書"  
  - `format`: "文章形式" / "SOAP形式"
  - `charLimit`: 100-1000文字

### 認証関連
- **POST `/api/auth/register`** - ユーザー登録
- **POST `/api/auth/login`** - ログイン
- **POST `/api/auth/google`** - Google OAuth認証
- **POST `/api/auth/logout`** - ログアウト
- **GET `/api/auth/verify`** - トークン検証

## データアーキテクチャ
- **AIエンジン**: Google Gemini 2.5 Flash API
- **データベース**: Cloudflare D1 SQLite (ユーザー・履歴管理)
- **ストレージ**: Cloudflare KV (セッション管理)
- **認証**: JWT + bcrypt暗号化
- **デプロイ**: Cloudflare Pages + Workers

## 品質・性能比較

### Gemini 2.5 Flash vs Claude 3 Haiku
| 項目 | Claude 3 Haiku | Gemini 2.5 Flash | 改善 |
|------|---------------|------------------|------|
| **1回コスト** | 0.27円 | 0.32円 | +18% |
| **文章品質** | 良好 | 優秀 | ⬆️ 大幅向上 |
| **SOAP論理性** | 基本 | 推論強化 | ⬆️ 大幅向上 |
| **専門用語精度** | 良好 | より正確 | ⬆️ 向上 |
| **応答時間** | 3-5秒 | 6-10秒 | やや遅い |

### 出力品質例
**入力**: 「利用者さん、今日は体調良さそう。血圧も安定してた。」
**出力**: 「利用者、本日全身状態良好であった。バイタルサインは安定しており、血圧も基準値内で推移した。」

## ユーザーガイド

### 基本的な使用手順
1. **📝 入力**: 思ったことやメモを自由に入力
2. **⚙️ 設定**: 文体・フォーマット・文字数を選択
3. **🚀 生成**: 「生成」ボタンをタップ
4. **📋 コピー**: 整った記録をクリップボードにコピー
5. **📄 活用**: 電子カルテに直接貼り付け

### 重要な注意点
- **🚫 個人情報厳禁**: 氏名・住所・生年月日等は入力禁止
- **✅ 事実ベース**: 入力情報のみ基づく出力、創作なし
- **📏 適切な長さ**: 入力に応じた適切な出力長に調整

## デプロイメント情報
- **プラットフォーム**: Cloudflare Pages
- **ステータス**: ✅ 本番稼働中
- **プロジェクト名**: tap-carte  
- **技術スタック**: Hono + TypeScript + Gemini 2.5 Flash + Cloudflare D1
- **最終更新**: 2025-10-07 (Gemini API設定完了・GitHub連携完了)

## 技術仕様

### 環境変数
```bash
GEMINI_API_KEY=your_gemini_api_key
JWT_SECRET=your_jwt_secret
GOOGLE_CLIENT_ID=your_google_client_id
```

### ローカル開発
```bash
npm install
npm run build
pm2 start ecosystem.config.cjs
curl http://localhost:3000
```

### 本番デプロイ
```bash
npx wrangler pages secret put GEMINI_API_KEY --project-name tap-carte
npm run build
npx wrangler pages deploy dist --project-name tap-carte
```

## 実装完了アーキテクチャ
- ✅ **認証システム**: JWT + Google OAuth
- ✅ **データベース**: Cloudflare D1 SQLite
- ✅ **AIエンジン**: Gemini 2.5 Flash (最新)
- ✅ **セキュリティ**: 個人情報検出・暗号化
- ✅ **レスポンシブUI**: 全デバイス対応
- ✅ **本番デプロイ**: Cloudflare Pages稼働中

## 今後の拡張候補
- [ ] 履歴機能UI実装 (バックエンド完成済み)
- [ ] 音声入力対応 (Web Speech API)
- [ ] テンプレート機能
- [ ] PDF/Word出力
- [ ] 使用状況分析ダッシュボード

---
**🏥 医療従事者の皆様の業務効率化をサポートします**